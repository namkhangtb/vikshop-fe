<div class="container mt-5 mb-5">
  <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
    <div class="card mb-3">
      <div class="card-header bg-light border-bottom">
        <span class="fw-bold"> Thông tin sản phẩm </span>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label class="form-label fw-semibold">Tên sản phẩm</label>
          <input
            type="text"
            class="form-control"
            placeholder="Nhập tên sản phẩm"
            formControlName="name"
          />
          <p
            *ngIf="
              productForm.get('name')?.invalid &&
              productForm.get('name')?.touched
            "
            class="error"
          >
            Vui lòng nhập tên sản phẩm
          </p>
        </div>
        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold">Mã sản phẩm (SKU)</label>
            <input
              type="text"
              class="form-control"
              formControlName="productId"
            />
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">Mã vạch</label>
            <input type="text" class="form-control" formControlName="barcode" />
          </div>
        </div>
        <div class="row mb-3 align-items-end">
          <label class="form-label fw-semibold">Khối lượng</label>
          <div class="input-group">
            <input
              type="number"
              min="0"
              class="form-control"
              formControlName="weight"
            />
            <span class="input-group-text fw-semibold">gram</span>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">Mô tả ngắn</label>
          <textarea
            class="form-control"
            rows="5"
            formControlName="shortDescription"
          ></textarea>
        </div>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header bg-light border-bottom">
        <span class="fw-bold"> Giá sản phẩm </span>
      </div>
      <div class="card-body">
        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá bán lẻ</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="retailPrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá nhập</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="importPrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá sỉ</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="wholesalePrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá livestream</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="livestreamPrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá thị trường</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="marketPrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Giá Upsale</label>
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                mask="separator.0"
                thousandSeparator="."
                formControlName="upsalePrice"
              />
              <span class="input-group-text fw-semibold">₫</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header bg-light border-bottom">
        <span class="fw-bold"> Ảnh sản phẩm </span>
      </div>
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <label class="btn btn-outline-secondary h-100 p-2 m-0">
              <div class="w-100">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 384 512"
                  width="80px"
                  height="80px"
                >
                  <path
                    d="M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM64 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm152 32c5.3 0 10.2 2.6 13.2 6.9l88 128c3.4 4.9 3.7 11.3 1 16.5s-8.2 8.6-14.2 8.6l-88 0-40 0-48 0-48 0c-5.8 0-11.1-3.1-13.9-8.1s-2.8-11.2 .2-16.1l48-80c2.9-4.8 8.1-7.8 13.7-7.8s10.8 2.9 13.7 7.8l12.8 21.4 48.3-70.2c3-4.3 7.9-6.9 13.2-6.9z"
                  />
                </svg>
              </div>
              <input
                type="file"
                hidden
                multiple
                (change)="onImageSelected($event)"
                accept="image/*"
              />
            </label>
          </div>
          <div
            *ngIf="productForm.get('images')?.value"
            class="d-flex align-items-center"
          >
            <ng-container
              *ngFor="
                let image of productForm.get('images')?.value;
                let i = index
              "
            >
              <div class="image-wrapper position-relative d-inline-block mx-1">
                <img
                  [src]="urlImage + '/uploads/' + image"
                  alt="Ảnh sản phẩm"
                  class="img-thumbnail h-100px w-100px object-fit-cover"
                />
                <button
                  type="button"
                  class="btn btn-danger btn-xs btn-close-custom"
                  (click)="removeImage(i)"
                >
                  ×
                </button>
              </div>
            </ng-container>
          </div>
        </div>
        <p
          *ngIf="productForm.get('images')?.errors?.['maxLength']"
          class="error"
        >
          Không thể tải thêm ảnh lên do quá số lượng tối đa cho phép (9 ảnh).
        </p>
      </div>
    </div>

    <div class="d-flex justify-content-end gap-2 mt-3">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="goToProductList()"
      >
        <i class="bi bi-arrow-left"></i> Quay lại danh sách
      </button>
      <button type="submit" class="btn btn-primary">
        <i class="bi bi-save"></i> Cập nhật sản phẩm
      </button>
    </div>
  </form>
</div>
